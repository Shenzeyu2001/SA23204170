<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Zeyu Shen" />

<meta name="date" content="2023-12-09" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Zeyu Shen</h4>
<h4 class="date">2023-12-09</h4>



<div id="hw0" class="section level1">
<h1>HW0</h1>
<p>Use knitr to produce at least 3 examples. For each exampletexts
should mix with figures and/or tables. Better to havemathematical
formulas.</p>
<div id="example-1" class="section level2">
<h2>Example 1</h2>
<p>The first example is an simple regression example based on a data set
which includes observations about weight and height. Because the higher
the height (H:height), the higher the weight (W:weight) is also larger,
so to judge whether the weight is overweight, you can not only look at
the body heavy, but also consider its height. To eliminate the
height-related component of body weight, consider a simple linear
regression model:</p>
<p><span class="math display">\[\log(W)=a+b\times\log(H)+\epsilon,\epsilon\sim
N(0,\sigma^2)\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(SA23204170)<span class="co">#之前作业用了一个不在R包里的数据集，所以这里要library一下自己的包</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;height_weight&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight<span class="sc">~</span>height,<span class="at">data =</span> <span class="fu">log</span>(data))</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">summary</span>(lm)<span class="sc">$</span>coef</span></code></pre></div>
<pre><code>##             Estimate Std. Error  t value     Pr(&gt;|t|)
## (Intercept) 2.598779 0.08843348 29.38682 6.122974e-74
## height      2.929655 0.16521364 17.73253 1.113946e-42</code></pre>
<p>The <span class="math inline">\(R^2\)</span> is 0.614815</p>
<p>Also ,I try to execute but not show the R codes</p>
<pre><code>##             Estimate Std. Error  t value     Pr(&gt;|t|)
## (Intercept) 2.598779 0.08843348 29.38682 6.122974e-74
## height      2.929655 0.16521364 17.73253 1.113946e-42</code></pre>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
<p>In this part ,still based on the same data set ,I show the first six
rows of it.</p>
<p>The resulting table:</p>
<div style="page-break-after: always;"></div>
</div>
<div id="example-3" class="section level2">
<h2>Example 3</h2>
<p>In this part ,I draw several plot about the linear model above:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">plot</span>(lm)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="利用逆变换法复现当replace-true时的sample函数" class="section level2">
<h2>利用逆变换法复现当（replace= TRUE）时的sample函数</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>my.sample<span class="ot">&lt;-</span><span class="cf">function</span>(data,size,<span class="at">prob=</span><span class="cn">NULL</span>){</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(prob)){</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    length <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    prob <span class="ot">&lt;-</span> (<span class="fu">numeric</span>(length)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>length</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  }</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  </span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">sum</span>(prob)<span class="sc">==</span><span class="dv">1</span>)<span class="co">#当给定的概率分布的和不为1时报错</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="co"># 生成[0, 1)之间的均匀随机数</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(size)</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="co"># 计算累积概率</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  cumulative_prob <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  <span class="co"># 找到所在区间</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">findInterval</span>(U,cumulative_prob)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  <span class="co"># 根据索引获取抽样的数据</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  sampled_data <span class="ot">&lt;-</span> data[index]</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  </span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>  <span class="fu">return</span>(sampled_data)</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>}</span></code></pre></div>
<p>接下来我们来测试函数</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># 不给定概率分布</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">my.sample</span>(letters,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;n&quot; &quot;o&quot; &quot;q&quot; &quot;l&quot; &quot;b&quot; &quot;y&quot; &quot;b&quot; &quot;l&quot; &quot;x&quot; &quot;d&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># 给定概率分布</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">my.sample</span>(letters,<span class="dv">10</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="fu">rep</span>(.<span class="dv">1</span>,<span class="dv">5</span>),<span class="fu">rep</span>(.<span class="dv">5</span><span class="sc">/</span><span class="dv">21</span>,<span class="dv">21</span>)))</span></code></pre></div>
<pre><code>##  [1] &quot;d&quot; &quot;j&quot; &quot;c&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;j&quot; &quot;a&quot; &quot;q&quot; &quot;g&quot;</code></pre>
</div>
<div id="question-3.2" class="section level2">
<h2>Question 3.2</h2>
<p>The standard Laplace distribution has density <span class="math display">\[f(x)=\frac12e^{-|x|},x\in\mathbb{R}.\]</span> Use
the inverse transform method to generate a random sample of size 1000
from this distribution.</p>
<p>通过积分可以得到Laplace分布的CDF为<span class="math display">\[\left.F(x)=\left\{\begin{array}{ll}\frac12e^x,&amp;x&lt;0\\1-\frac12e^{-x},&amp;x\geq0.\end{array}\right.\right.\]</span>
可以发现CDF在<span class="math inline">\(x=0\)</span>处有变化，于是对生成一个随机变量<span class="math inline">\(U\sim U(0,1)\)</span>,如果<span class="math inline">\(u&lt;\frac{1}{2}\)</span>,那么<span class="math inline">\(u=\frac{1}{2}e^x\)</span>，如果<span class="math inline">\(u\geq \frac{1}{2}\)</span>,那么,<span class="math inline">\(u=1-\frac{1}{2}e^{-x}\)</span>,因此，逆分布为<span class="math display">\[\left.x=F^{-1}(u)=\left\{\begin{array}{ll}\log(2u),&amp;0&lt;u&lt;\frac{1}{2}.\\-\log(2-2u),&amp;\frac{1}{2}\leq
u&lt;1\end{array}\right.\right.\]</span>。</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">which</span>(u <span class="sc">&gt;=</span> <span class="fl">0.5</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2-2</span> <span class="sc">*</span> u[index]), <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> u[<span class="sc">-</span>index]))</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">7</span>,<span class="dv">7</span>))</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co"># 经验密度函数</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co"># 理论密度函数</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>x_positive<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">qexp</span>(<span class="fu">ppoints</span>(<span class="dv">100</span>), <span class="at">rate =</span> <span class="dv">1</span>))</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>x_negative<span class="ot">&lt;-</span><span class="sc">-</span><span class="fu">rev</span>(x_positive)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="fu">lines</span>(x_negative, <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">exp</span>(x_negative),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="fu">lines</span>(x_positive, <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x_positive),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.7" class="section level2">
<h2>Question 3.7</h2>
<p>Write a function to generate a random sample of size n from the
Beta(a, b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
<p>取<span class="math inline">\(g(x)\)</span>为<span class="math inline">\(U(0,1)\)</span>的密度函数即<span class="math inline">\(g(x)=1\)</span>,那么有<span class="math display">\[\frac{f(x)}{g(x)}=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\frac{x^{a-1}(1-x)^{b-1}}1\leq\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)},\quad0&lt;x&lt;1\]</span>。取常数<span class="math inline">\(c=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\)</span>，那么<span class="math inline">\(\frac{f(x)}{cg(x)}\leq
1\)</span>。生成随机变量<span class="math inline">\(U\sim
U(0,1)\)</span>，如果<span class="math inline">\(u\leq
x^{a-1}(1-x)^{b-1}\)</span>，则接受<span class="math inline">\(x\)</span>，否则就拒绝。</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>my.rbeta <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b) {</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span>(a <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> x)<span class="sc">^</span>(b <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">&gt;</span> u) {</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>      y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    }</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a> }</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="fu">return</span>(y)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>} </span></code></pre></div>
<p>生成大小为1000，服从<span class="math inline">\(B(3,2)\)</span>分布的随机样本。</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>beta_sample<span class="ot">&lt;-</span><span class="fu">my.rbeta</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">hist</span>(beta_sample, <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># 经验密度函数</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(beta_sample),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># 理论密度函数</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>fy <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">*</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> y)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="fu">lines</span>(y, fy,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.9" class="section level2">
<h2>Question 3.9</h2>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function
<span class="math inline">\(f_e(x)=\frac34(1-x^2),\quad|x|\leq1.\)</span>
Devroye and Gy¨orfi [71, p. 236] give the following algorithm for
simulation from this distribution. Generate iid <span class="math inline">\(U1, U2, U3 \sim Uniform(−1, 1)\)</span>. If <span class="math inline">\(|U3|\geq |U2|\)</span> and <span class="math inline">\(|U3|\geq |U1|\)</span>, deliver U2; otherwise
deliver U3. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density
estimate of a large simulated random sample.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>my.gen<span class="ot">&lt;-</span><span class="cf">function</span>(n){</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  u1<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  u2<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  u3<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    <span class="cf">if</span> ((<span class="fu">abs</span>(u3[i]) <span class="sc">&gt;=</span> <span class="fu">abs</span>(u2[i])) <span class="sc">&amp;&amp;</span> (<span class="fu">abs</span>(u3[i]) <span class="sc">&gt;=</span> <span class="fu">abs</span>(u1[i])))</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> u2[i]</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    <span class="cf">else</span> x[i] <span class="ot">&lt;-</span> u3[i]</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  }</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>}</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">my.gen</span>(<span class="dv">10000</span>)</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co"># 经验密度函数</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co"># 理论密度函数</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>fy <span class="ot">&lt;-</span> <span class="fl">0.75</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> y<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="fu">lines</span>(y, fy,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="question-1.2" class="section level2">
<h2>Question 1.2</h2>
<p>Take three different values of <span class="math inline">\(\rho\)</span> (0 ≤ <span class="math inline">\(\rho\)</span> ≤ 1, including ρmin) and use Monte
Carlo simulation to verify your answer. (n = <span class="math inline">\(10^6\)</span>, Number of repeated simulations K =
100)</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># 把整个蒙特卡罗计算pi估计值的的过程整合为一个函数</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>var_pihat <span class="ot">&lt;-</span> <span class="cf">function</span>(rho){</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  l <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">*</span>rho</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  pihat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>    pihat[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  }</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  <span class="fu">var</span>(pihat)</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>}</span></code></pre></div>
<p>接下来选取<span class="math inline">\(\rho=0.3\)</span>,<span class="math inline">\(\rho=0.6\)</span>以及<span class="math inline">\(\rho=1\)</span>来验证</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># rho=0.3</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">var_pihat</span>(<span class="fl">0.3</span>)</span></code></pre></div>
<pre><code>## [1] 3.014792e-05</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># rho=0.6</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">var_pihat</span>(<span class="fl">0.6</span>)</span></code></pre></div>
<pre><code>## [1] 1.868274e-05</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># rho=1</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">var_pihat</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 4.745937e-06</code></pre>
<p>我们可以发现得到的方差确实在递减，且<span class="math inline">\(\rho=1\)</span>时最小。</p>
</div>
<div id="ex-5.6" class="section level2">
<h2>Ex 5.6</h2>
<p>Consider the antithetic variate approach to estimating<span class="math display">\[\theta=\int_0^1e^xdx.\]</span> Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^{U}+e^{1-U})\)</span>, where<span class="math inline">\(U\sim U(0,1)\)</span>. What is the percent
reduction in variance of <span class="math inline">\(\hat\theta\)</span>
that can be achieved using antithetic variate (compared with simple
MC)?</p>
<p>我们很容易就能算得 <span class="math display">\[Cov(e^U,e^{1-U})=E[e^Ue^{1-U}]-E[e^U]E[e^{(1-U}]=e-(e-1)^2,\]</span>
<span class="math display">\[Var(e^U)=E[e^{2U}]-(E[e^U])^2=\frac12(e^2-1)-(e-1)^2,\]</span>
以及<span class="math display">\[Var(\frac{1}{2}(e^U+e^{1-U}))=\frac{1}{4}(2Var(e^U)+2Cov(e^U,e^{1-U}))=\frac12(\frac12(e^2-1)-(e-1)^2+e-(e-1)^2),\]</span>其中最后一项即为使用对偶变量法时的方差。</p>
<p>考虑<span class="math inline">\(U,V ~~~ i.i.d.\sim
U(0,1)\)</span>，不使用对偶变量法时，方差为<span class="math display">\[Var(\frac12(e^U+e^V))=\frac142Var(e^U)=\frac12(\frac{1}{2}(e^2-1)-(e-1)^2),\]</span></p>
<p>那么易算得方差减少的比例为</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>v_mc <span class="ot">&lt;-</span> .<span class="dv">5</span><span class="sc">*</span>(.<span class="dv">5</span><span class="sc">*</span>(<span class="fu">exp</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">-</span>(<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>v_anti <span class="ot">&lt;-</span>.<span class="dv">5</span><span class="sc">*</span>(.<span class="dv">5</span><span class="sc">*</span>(<span class="fu">exp</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">-</span>(<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span>(<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>(v_mc<span class="sc">-</span>v_anti)<span class="sc">/</span>v_mc                                         </span></code></pre></div>
<pre><code>## [1] 0.9676701</code></pre>
</div>
<div id="ex-5.7" class="section level2">
<h2>Ex 5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">exp</span>(<span class="fu">runif</span>(m)))</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  })</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>anti <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="fu">mean</span>((<span class="fu">exp</span>(U)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>  })</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co"># 两种方法得到的估计值</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(mc), <span class="fu">mean</span>(anti))</span></code></pre></div>
<pre><code>## [1] 1.717870 1.718284</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># 两种方法的方差</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">var</span>(mc), <span class="fu">var</span>(anti))</span></code></pre></div>
<pre><code>## [1] 2.304748e-05 7.604415e-07</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># 方差减少的比例</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>(<span class="fu">var</span>(mc) <span class="sc">-</span> <span class="fu">var</span>(anti))<span class="sc">/</span><span class="fu">var</span>(mc)</span></code></pre></div>
<pre><code>## [1] 0.9670054</code></pre>
<p>可以发现，模拟算得的减少比例与理论值相差无几。</p>
</div>
</div>
<div id="hw3" class="section level1">
<h1>HW3</h1>
<div id="ex-5.13" class="section level2">
<h2>Ex 5.13</h2>
<p>我选择正态分布<span class="math inline">\(N(1,1)\)</span>和t分布<span class="math inline">\(t(1)\)</span>作为重要函数<span class="math inline">\(f_1\)</span>和<span class="math inline">\(f_2\)</span>.首先画出图像。</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, .<span class="dv">01</span>)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="fu">plot</span>(x, g, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="dv">2</span><span class="sc">*</span><span class="fu">dt</span>(x<span class="dv">-1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">inset =</span> <span class="fl">0.02</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>, <span class="st">&quot;f1&quot;</span>, <span class="st">&quot;f2&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>此处取的是正态分布和t分布密度函数的一半，故对密度函数做了一些正则化，具体为将密度函数向右平移1个单位后乘二。接下来考虑<span class="math inline">\(g(x)/f(x)\)</span>。</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">plot</span>(x,g<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x, <span class="dv">1</span>, <span class="dv">1</span>)), <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">dt</span>(x<span class="dv">-1</span>, <span class="dv">1</span>)), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">inset =</span> <span class="fl">0.02</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;f1&quot;</span>, <span class="st">&quot;f2&quot;</span>), <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以看到<span class="math inline">\(f_1\)</span>对应的比值曲线更平缓，那么应该选用<span class="math inline">\(f_1\)</span>作为重要函数，保守起见仍计算标准差来比较。</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>est <span class="ot">&lt;-</span> sd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fl">1e6</span>)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)}</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="fl">1e6</span>))<span class="sc">+</span><span class="dv">1</span> <span class="co">#使用f1</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>est[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>sd[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rt</span>(<span class="fl">1e6</span>,<span class="dv">1</span>))<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">dt</span>(x<span class="dv">-1</span>, <span class="dv">1</span>))</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>est[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>sd[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a><span class="fu">names</span>(sd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>)</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>sd</span></code></pre></div>
<pre><code>##         f1         f2 
## 0.04406203 0.24608762</code></pre>
<p>很明显看出使用<span class="math inline">\(f_1\)</span>更合适。</p>
</div>
<div id="ex-5.14" class="section level2">
<h2>Ex 5.14</h2>
<p>由Ex 5.13，取<span class="math inline">\(f_1\)</span>为重要函数时，估计为</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>est[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 0.4006073</code></pre>
</div>
<div id="ex-5.15" class="section level2">
<h2>Ex 5.15</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){k<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)}</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> M<span class="sc">/</span>k</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>theta <span class="ot">&lt;-</span> v <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>k, j<span class="sc">/</span>k)</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">*</span> u)</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>  theta[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>  v[j] <span class="ot">&lt;-</span> <span class="fu">var</span>(fg)</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>}</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a><span class="fu">sum</span>(theta)</span></code></pre></div>
<pre><code>## [1] 0.5248499</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(v))</span></code></pre></div>
<pre><code>## [1] 0.004177585</code></pre>
<p>不分层的情况下</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)}</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(M)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">*</span> u)</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>theta</span></code></pre></div>
<pre><code>## [1] 0.5244027</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>sd</span></code></pre></div>
<pre><code>## [1] 0.09729972</code></pre>
<p>可看到明显使用了分层抽样的标准差更小。</p>
</div>
<div id="ex-6.5" class="section level2">
<h2>Ex 6.5</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="at">expr =</span> {</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">+</span> t0 <span class="sc">*</span> <span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>})</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>LCL <span class="ot">&lt;-</span> CI[<span class="dv">1</span>,]</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> CI[<span class="dv">2</span>,]</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a><span class="fu">mean</span>(LCL <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> UCL <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.9206</code></pre>
<p>显然这个区间比方差区间要更稳健。</p>
</div>
<div id="ex-6.a" class="section level2">
<h2>Ex 6.A</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="cf">function</span>(distribution){</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>  count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>  <span class="cf">if</span>(distribution<span class="sc">==</span><span class="st">&quot;chisq&quot;</span>){</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>     data <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">30</span>, <span class="at">df =</span> <span class="dv">1</span>)</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(data, <span class="at">mu =</span> <span class="dv">1</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>      <span class="cf">if</span> (result<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>        count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>      } </span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>    }</span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>  }</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>  <span class="cf">if</span>(distribution<span class="sc">==</span><span class="st">&quot;unif&quot;</span>){</span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>     data <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2</span>)</span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(data, <span class="at">mu =</span> <span class="dv">1</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a>      <span class="cf">if</span> (result<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a>        count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a>      } </span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a>    }</span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a>  }</span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a>  <span class="cf">if</span>(distribution<span class="sc">==</span><span class="st">&quot;exp&quot;</span>){</span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a>     data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">30</span>, <span class="at">rate =</span> <span class="dv">1</span>) </span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(data, <span class="at">mu =</span> <span class="dv">1</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a>      <span class="cf">if</span> (result<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a>        count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb45-29"><a href="#cb45-29" tabindex="-1"></a>      } </span>
<span id="cb45-30"><a href="#cb45-30" tabindex="-1"></a>    }</span>
<span id="cb45-31"><a href="#cb45-31" tabindex="-1"></a>  }</span>
<span id="cb45-32"><a href="#cb45-32" tabindex="-1"></a>  <span class="fu">return</span>(count<span class="sc">/</span>m)</span>
<span id="cb45-33"><a href="#cb45-33" tabindex="-1"></a>}</span></code></pre></div>
<p>对<span class="math inline">\(\chi^2(1)\)</span>，经验一类错误率为</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">test</span>(<span class="st">&quot;chisq&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.0901</code></pre>
<p>对<span class="math inline">\(U(0,2)\)</span>，经验一类错误率为</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">test</span>(<span class="st">&quot;unif&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.0493</code></pre>
<p>对<span class="math inline">\(exp(1)\)</span>,经验一类错误率为</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">test</span>(<span class="st">&quot;exp&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.0734</code></pre>
</div>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
<div id="问题1" class="section level2">
<h2>问题1</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">1</span></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>rep<span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,{</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>  H0 <span class="ot">&lt;-</span> <span class="fu">runif</span>(.<span class="dv">95</span><span class="sc">*</span>m,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>  H1 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(.<span class="dv">05</span><span class="sc">*</span>m,.<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>(H0,H1)</span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>  p.adj1 <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&#39;BH&#39;</span>)</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>  p.adj2 <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>  FWER <span class="ot">&lt;-</span> FDR <span class="ot">&lt;-</span> TPR <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a>  FDR[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj1[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="fu">sum</span>(p.adj1<span class="sc">&lt;</span>alpha)</span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a>  FDR[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj2[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="fu">sum</span>(p.adj2<span class="sc">&lt;</span>alpha)</span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a>  FWER[<span class="dv">1</span>] <span class="ot">&lt;-</span> (<span class="fu">sum</span>(p.adj1[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a>  FWER[<span class="dv">2</span>] <span class="ot">&lt;-</span> (<span class="fu">sum</span>(p.adj2[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a>  TPR[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj1[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>)]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a>  TPR[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj2[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>)]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a>  <span class="fu">c</span>(FWER,FDR,TPR)</span>
<span id="cb52-19"><a href="#cb52-19" tabindex="-1"></a>})</span>
<span id="cb52-20"><a href="#cb52-20" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">apply</span>(rep,<span class="dv">1</span>,<span class="at">FUN=</span>mean)</span>
<span id="cb52-21"><a href="#cb52-21" tabindex="-1"></a></span>
<span id="cb52-22"><a href="#cb52-22" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">round</span>(result,<span class="dv">3</span>),<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb52-23"><a href="#cb52-23" tabindex="-1"></a><span class="fu">colnames</span>(A)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>,<span class="st">&quot;FDR&quot;</span>,<span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb52-24"><a href="#cb52-24" tabindex="-1"></a><span class="fu">rownames</span>(A)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;B-H&quot;</span>,<span class="st">&quot;Bonferroni&quot;</span>)</span>
<span id="cb52-25"><a href="#cb52-25" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(A, <span class="at">format =</span> <span class="st">&quot;latex&quot;</span>)</span></code></pre></div>
</div>
<div id="问题2" class="section level2">
<h2>问题2</h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span>          <span class="co"># 真实参数 lambda</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)  <span class="co"># 样本大小</span></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span>                 <span class="co"># 重抽样次数</span></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span>                 <span class="co"># boot次数</span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>mean_bias <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(size))      </span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>mean_sd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(size))  </span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a><span class="co"># 模拟循环</span></span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(size)) {</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>  n <span class="ot">&lt;-</span> size[i]   <span class="co"># 当前样本大小</span></span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>  bias <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)   <span class="co"># 每次模拟的bias</span></span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>  sd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  <span class="co"># 每次模拟的sd</span></span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>  </span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a>    <span class="co"># 生成样本</span></span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> <span class="dv">1</span><span class="sc">/</span>lambda)</span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a>    </span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a>    <span class="co"># Boot</span></span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a>    boot <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>      data_b <span class="ot">&lt;-</span> <span class="fu">sample</span>(data, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a>      lambda_b <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(data_b)</span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a>      lambda_b</span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a>    })</span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a>    </span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a>    <span class="co"># 计算偏差和标准误差</span></span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a>    lambda_hat <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(data)</span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a>    bias[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot) <span class="sc">-</span> lambda_hat</span>
<span id="cb53-29"><a href="#cb53-29" tabindex="-1"></a>    sd[j] <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot)</span>
<span id="cb53-30"><a href="#cb53-30" tabindex="-1"></a>  }</span>
<span id="cb53-31"><a href="#cb53-31" tabindex="-1"></a>  </span>
<span id="cb53-32"><a href="#cb53-32" tabindex="-1"></a>  mean_bias[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bias)</span>
<span id="cb53-33"><a href="#cb53-33" tabindex="-1"></a>  mean_sd[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sd)</span>
<span id="cb53-34"><a href="#cb53-34" tabindex="-1"></a>}</span>
<span id="cb53-35"><a href="#cb53-35" tabindex="-1"></a></span>
<span id="cb53-36"><a href="#cb53-36" tabindex="-1"></a><span class="co"># 理论值</span></span>
<span id="cb53-37"><a href="#cb53-37" tabindex="-1"></a>theo_bias <span class="ot">&lt;-</span> lambda <span class="sc">/</span> (size <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb53-38"><a href="#cb53-38" tabindex="-1"></a>theo_sd <span class="ot">&lt;-</span> lambda <span class="sc">*</span> <span class="fu">sqrt</span>(size) <span class="sc">/</span> ((size <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(size <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb53-39"><a href="#cb53-39" tabindex="-1"></a></span>
<span id="cb53-40"><a href="#cb53-40" tabindex="-1"></a></span>
<span id="cb53-41"><a href="#cb53-41" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">round</span>(<span class="fu">c</span>(size,mean_bias,theo_bias,mean_sd,theo_sd),<span class="dv">3</span>),<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb53-42"><a href="#cb53-42" tabindex="-1"></a><span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;SIze&quot;</span>,<span class="st">&quot;sim_bias&quot;</span>,<span class="st">&quot;theo_bias&quot;</span>,<span class="st">&quot;sim_sd&quot;</span>,<span class="st">&quot;theo_sd&quot;</span>)</span>
<span id="cb53-43"><a href="#cb53-43" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result, <span class="at">format =</span> <span class="st">&quot;latex&quot;</span>)</span></code></pre></div>
</div>
<div id="ex-7.3" class="section level2">
<h2>Ex 7.3</h2>
<p>Obtain a bootstrap t confidence interval estimate for the correlation
statistic in Example 7.2 (law data in bootstrap).</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## Warning: package &#39;boot&#39; was built under R version 4.2.2</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">attach</span>(law)  </span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>cor.stat <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>  <span class="fu">cor</span>(x[i, <span class="dv">1</span>], x[i, <span class="dv">2</span>])  <span class="co"># 计算相关性统计量</span></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>}</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>cor.stat2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>  o <span class="ot">&lt;-</span> <span class="fu">boot</span>(x[i, ], cor.stat, <span class="at">R =</span> <span class="dv">100</span>)</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(i)  <span class="co"># 样本大小</span></span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>  <span class="co"># 返回相关性统计量和方差估计</span></span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>  <span class="fu">c</span>(o<span class="sc">$</span>t0, <span class="fu">var</span>(o<span class="sc">$</span>t) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>}</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a><span class="co"># 使用boot函数执行Bootstrap分析</span></span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">boot</span>(law, <span class="at">statistic =</span> cor.stat2, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a></span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(b, <span class="at">type =</span> <span class="st">&quot;stud&quot;</span>)</span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = b, type = &quot;stud&quot;)
## 
## Intervals : 
## Level    Studentized     
## 95%   (-0.6736,  1.0055 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="ex-7.5" class="section level2">
<h2>Ex 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> aircondit</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>meant <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">as.matrix</span>(x[i, ])))</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">boot</span>(x, <span class="at">statistic =</span> meant, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a><span class="fu">boot.ci</span>(b, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = b, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 32.4, 180.8 )   ( 23.5, 167.2 )  
## 
## Level     Percentile            BCa          
## 95%   ( 48.9, 192.7 )   ( 58.3, 229.0 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>有区别的原因是：
(1)样本分布不是正态分布，因此分位数法的结果和正太法的结果不同。
(2)抽样次数不够，不能很好的使用中心极限定理得到渐近分布。
(3)Bca和分位数法不同是因为其纠正了偏度。</p>
</div>
<div id="ex-7.8" class="section level2">
<h2>Ex 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(scor)</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda<span class="sc">/</span><span class="fu">sum</span>(lambda))</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>  y <span class="ot">&lt;-</span> x[<span class="sc">-</span>i, ]</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">cov</span>(y)</span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(s)<span class="sc">$</span>values</span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda<span class="sc">/</span><span class="fu">sum</span>(lambda))</span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>  }</span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta.jack) <span class="sc">-</span> theta.hat)</span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((theta.jack <span class="sc">-</span> <span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>(theta.hat, bias.jack, se.jack)</span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">round</span>(result,<span class="dv">3</span>),<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a><span class="fu">colnames</span>(A)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;Bias&quot;</span>,<span class="st">&quot;Standard Error&quot;</span>)</span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(A, <span class="at">format =</span> <span class="st">&quot;latex&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
</div>
<div id="ex-8.1" class="section level1">
<h1>Ex 8.1</h1>
<p>Implement the two-sample Cram´er-von Mises test for equal
distributions as a permutation test, where the statistics is<span class="math display">\[W_2=\frac{mn}{(m+n)^2}\left[\sum_{i=1}^n(F_n(x_i)-G_m(x_i))^2+\sum_{j=1}^m(F_n(y_j)-G_m(y_j))^2\right]\]</span></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb61-8"><a href="#cb61-8" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb61-9"><a href="#cb61-9" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb61-10"><a href="#cb61-10" tabindex="-1"></a>N <span class="ot">&lt;-</span> n <span class="sc">+</span> m</span>
<span id="cb61-11"><a href="#cb61-11" tabindex="-1"></a>K <span class="ot">&lt;-</span> Fn <span class="ot">&lt;-</span> Gm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb61-12"><a href="#cb61-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb61-13"><a href="#cb61-13" tabindex="-1"></a>  Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(z[i] <span class="sc">&lt;=</span> x))</span>
<span id="cb61-14"><a href="#cb61-14" tabindex="-1"></a>  Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(z[i] <span class="sc">&lt;=</span> y))</span>
<span id="cb61-15"><a href="#cb61-15" tabindex="-1"></a>}</span>
<span id="cb61-16"><a href="#cb61-16" tabindex="-1"></a>stat0 <span class="ot">&lt;-</span> ((n <span class="sc">*</span> m)<span class="sc">/</span>N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb61-17"><a href="#cb61-17" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R,{</span>
<span id="cb61-18"><a href="#cb61-18" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb61-19"><a href="#cb61-19" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> z[K]</span>
<span id="cb61-20"><a href="#cb61-20" tabindex="-1"></a>  X <span class="ot">&lt;-</span> Z[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb61-21"><a href="#cb61-21" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> Z[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb61-22"><a href="#cb61-22" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb61-23"><a href="#cb61-23" tabindex="-1"></a>    Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(Z[i] <span class="sc">&lt;=</span> X))</span>
<span id="cb61-24"><a href="#cb61-24" tabindex="-1"></a>    Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(Z[i] <span class="sc">&lt;=</span> Y))</span>
<span id="cb61-25"><a href="#cb61-25" tabindex="-1"></a>    }</span>
<span id="cb61-26"><a href="#cb61-26" tabindex="-1"></a>  ((n <span class="sc">*</span> m)<span class="sc">/</span>N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb61-27"><a href="#cb61-27" tabindex="-1"></a>})</span>
<span id="cb61-28"><a href="#cb61-28" tabindex="-1"></a>stat1 <span class="ot">&lt;-</span><span class="fu">c</span>(stat0,stat)</span>
<span id="cb61-29"><a href="#cb61-29" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The statistic is&quot;</span>,<span class="fu">round</span>(stat0,<span class="dv">3</span>),<span class="st">&quot;.&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## The statistic is 4.228 .</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The p-value is&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(stat1 <span class="sc">&gt;=</span> stat0),<span class="dv">3</span>),<span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<pre><code>## The p-value is 0.386 .</code></pre>
<div id="ex-8.3" class="section level2">
<h2>Ex 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>maxout <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx,outy)))</span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>}</span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a></span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a>max.text <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,<span class="at">R=</span><span class="dv">999</span>){</span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(z)</span>
<span id="cb65-13"><a href="#cb65-13" tabindex="-1"></a>  stat0 <span class="ot">&lt;-</span> <span class="fu">maxout</span>(x,y)</span>
<span id="cb65-14"><a href="#cb65-14" tabindex="-1"></a>  stat <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R,{</span>
<span id="cb65-15"><a href="#cb65-15" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb65-16"><a href="#cb65-16" tabindex="-1"></a>    k1 <span class="ot">&lt;-</span> k[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb65-17"><a href="#cb65-17" tabindex="-1"></a>    k2 <span class="ot">&lt;-</span> k[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb65-18"><a href="#cb65-18" tabindex="-1"></a>    <span class="fu">maxout</span>(z[k1], z[k2])</span>
<span id="cb65-19"><a href="#cb65-19" tabindex="-1"></a>  })</span>
<span id="cb65-20"><a href="#cb65-20" tabindex="-1"></a>  stat1 <span class="ot">&lt;-</span> <span class="fu">c</span>(stat0,stat)</span>
<span id="cb65-21"><a href="#cb65-21" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(stat1 <span class="sc">&gt;=</span> stat0)</span>
<span id="cb65-22"><a href="#cb65-22" tabindex="-1"></a>  <span class="fu">return</span>(p_value)</span>
<span id="cb65-23"><a href="#cb65-23" tabindex="-1"></a>}</span></code></pre></div>
<p>接下来对这个函数做些测试，考虑方差相同与不相同两种情况，计算他们的power。</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="co"># 方差相同</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,{</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">40</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>  <span class="fu">max.text</span>(x,y)</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>})</span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>power<span class="ot">&lt;-</span> <span class="fu">sum</span>(p<span class="sc">&lt;</span>.<span class="dv">05</span>)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Power is&quot;</span>,power,<span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Power is 0.038 .</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="co"># 方差不同</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,{</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">40</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>  <span class="fu">max.text</span>(x,y)</span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>})</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>power<span class="ot">&lt;-</span> <span class="fu">sum</span>(p<span class="sc">&lt;</span>.<span class="dv">05</span>)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Power is&quot;</span>,power,<span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Power is 0.853 .</code></pre>
</div>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
<div id="ex-1" class="section level2">
<h2>Ex 1</h2>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N)</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>  }</span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">10</span>))</span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="at">alpha=</span>solution<span class="sc">$</span>root)</span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>b1 <span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">01</span>,.<span class="dv">001</span>,.<span class="dv">0001</span>)</span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a><span class="fu">alpha</span>(N,b1,b2,b3,f0[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] -3.165928</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">alpha</span>(N,b1,b2,b3,f0[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] -6.077476</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">alpha</span>(N,b1,b2,b3,f0[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## [1] -8.740117</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">alpha</span>(N,b1,b2,b3,f0[<span class="dv">4</span>])</span></code></pre></div>
<pre><code>## [1] -11.31855</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>neg_logf0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="dv">2</span>,<span class="at">length.out=</span><span class="dv">10</span>),<span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="at">length.out=</span><span class="dv">20</span>))</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>alpha_seq <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">30</span>)</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>) {</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>  alpha_seq[i] <span class="ot">&lt;-</span> <span class="fu">alpha</span>(N,b1,b2,b3,<span class="fu">exp</span>(<span class="sc">-</span>neg_logf0[i]))</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>}</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a><span class="fu">plot</span>(neg_logf0,alpha_seq,<span class="at">xlab =</span> <span class="fu">expression</span>(<span class="sc">-</span>logf_0),<span class="at">ylab =</span> <span class="st">&quot;alpha&quot;</span>,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmtv+QOgCQZgCQkGaQvJCQ2/+2ZgC2tma2/7a2///bkDrb////tmb/25D//7b//9v///93vabhAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG9ElEQVR4nO2dCVejSBRGcZvRbnvGzEij5v//z2aJkWCqLrXBI/nuOZ3jaeRV5aY2wius9sJLtXYFrCNBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBIYLenx7b16aqqtvXUvUxR7Cg+u5399PPYjUyRqigg5pe07lwm6GUoLeHXlBz2snCy12bYoKoBQWEW5VCgro2cr//HK4Tw61KEUH73tHNSzuROfwcwm1AUylB88JJEISTIApn35AEARIESBAgQcDKguwbkiBAggAJAiQIkCBgbUHmDUkQIEGABAESBKwuyLohCQIkCJAgYH1Bxg1JEFBI0MfzcAfemf5SOX42RxlB9ecdVeet1esW9PF81DIrecGyoULJC8e0qXnpL4YNmWhBlg2VGoMOTWjWGBQcfkkKzWJDhlBVOdrPmXBWDRlYB5UpIBcRgj5bR1KK75lybRqKELS7+13ffyZp5izXpKFwQV3aYdOOLa75KaFci4ZiBP3cv/392v/LXa7B7OBwQd0i5/3HSxFBBhtRxBhUt6Pz7rFEF+sPGFMUM83v7ruZLG2fiqdcW4bsrINGxywpsijIlKIIQfhlWI5yzSiKWSjm2CXH5RoxFLdQXKRcG40obqG4ULkWFMUsFO+XK3d9RRFjUOJlanS56xBY0c+vOorPYqPfXFeRzXVQ0aLD2IKgVRtRjKC+nyVdqgb7Xk9RhKDm5qV9rfvX8uUeT1hJUcw0P0xiuzJfd2Q9JQMRC8UfQ9NpFprFRuesoSi+BRX6wsx/1vKKYsag/rbp8eZp4XKn5y3tKOZaLMdaMeFtLqtoE+ugbycvqGhhQbme/rJcT9tkCxoiLKPI/sWqJ8YSirbbgvoo5RVtW9ACigylv8RGKqvIUvpLdKySikylv8RHK6fIVvpLQrxSiqylvyRELKPIXPqLsZgW018SghaIuvV10DRs9rgXJij/ZezFCdpnbkaXKCirossUlLGnXaqgfa5mdMGC8ii6aEE5FF24oHRFhQQFbQsvTJqiMoLCtoUXJ2VKKyIofFNvcaLvNBUR5N4WHhUuF1GKrqUFHUoNL7bUGBS6LXwpgsstNIuFbwtfitBGdPHroDNFB5V9hYLCprSrFNRXYKajjaa/ZGFWJQqtgzAHxIKgWYrKtKCPZ7rnYUPQDEXFLlZhz5QVQaio1BjUQBKsHUGg6GpnsRM8k4YEHXApKilodM2aI1xpziuSoBHnFEnQCd8VSdCEqSIJ+sbplKZZ7Byji0UJcnFQJEGABAESBEgQsJqgzbCSoHlB4Xja4dTT0349T1AJSjsuQRKUdlyCJCjtuARJUNrxyxd0SUgQIEGABAESBEgQIEGABAESBEgQIEGABAESBOQX1FSV75HL/a5O/1+o8D2Q+O2hqnyZtnUb3Zlnenj0D9TwlOyCusdSN+7yP57bY7X3PTaep353z8h6f3Kf3T0O25mJ+/7Up3lDDSfkFjQkD+2cb2F4RlrtSUh/f3ILGqK7zx7yuB2lN8P+AKrhhNyCWECH7wOs7345Bb395f/gfYKa6rHfSDqvhkeyC+rfAj212/N3hNoA7jGouf3/yTuCebvYUK15NTySW9DQNqCLO3d0Dh3ALajuOol3P4R3AO6tzKrhF2sIajxjdLdb2CPoBj79rmm+Pbj0WxA0owF72s9wukdQH9f9MEwYXyx0MR4Ca+8YckhOcRgY3pZ7qIbWYWGQxkl0xkPz3S1oeLSB+9Mf3rzzeGNgmqdlmHuA+MKzku6GKF+e9owxaOWFYt9LfKucoQt56+e71GjgQmXnO35oWv4aTtDFKiBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRYFDR6dv6I+uSOYFCeYQqbEdT9Fc8vwm4fp7AhQaP/DExASMGsoONN+F3bmf65+fdh/IjmwBSWFKwK6hIN+3zfLl+jacebkxYUmASVglFBQx9qR5mhrewmggLT6FIwKmjw0r4eU3quXtDukHx3PxLU/lCfFaQuBi1Ig/RkDKongjTNwyymheLpOuj2v9vXyeoxKM8wBYuCvrPIcHwe64L6Mej0OmxZrAvqu9oh97zbbchJxJkxL2htJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCgD975ZKMPxS/GAAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="ex-9.4" class="section level2">
<h2>Ex 9.4</h2>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>    rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>        x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>        u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>            y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a>                <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(x[i<span class="dv">-1</span>]) <span class="sc">-</span> <span class="fu">abs</span>(y))){</span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a>                   x[i] <span class="ot">&lt;-</span> y  </span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a>                   k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a>                  }</span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a>                <span class="cf">else</span> {</span>
<span id="cb80-14"><a href="#cb80-14" tabindex="-1"></a>                    x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb80-15"><a href="#cb80-15" tabindex="-1"></a>                }</span>
<span id="cb80-16"><a href="#cb80-16" tabindex="-1"></a>            }</span>
<span id="cb80-17"><a href="#cb80-17" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb80-18"><a href="#cb80-18" tabindex="-1"></a>    }</span>
<span id="cb80-19"><a href="#cb80-19" tabindex="-1"></a></span>
<span id="cb80-20"><a href="#cb80-20" tabindex="-1"></a>    </span>
<span id="cb80-21"><a href="#cb80-21" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb80-22"><a href="#cb80-22" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">4</span>,  <span class="dv">16</span>)</span>
<span id="cb80-23"><a href="#cb80-23" tabindex="-1"></a></span>
<span id="cb80-24"><a href="#cb80-24" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb80-25"><a href="#cb80-25" tabindex="-1"></a>    rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb80-26"><a href="#cb80-26" tabindex="-1"></a>    rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb80-27"><a href="#cb80-27" tabindex="-1"></a>    rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb80-28"><a href="#cb80-28" tabindex="-1"></a>    rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb80-29"><a href="#cb80-29" tabindex="-1"></a></span>
<span id="cb80-30"><a href="#cb80-30" tabindex="-1"></a>    </span>
<span id="cb80-31"><a href="#cb80-31" tabindex="-1"></a>    <span class="co">#number of candidate points accepted</span></span>
<span id="cb80-32"><a href="#cb80-32" tabindex="-1"></a>    accept.rate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sigma=</span>sigma,<span class="at">accept.rate=</span><span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k)<span class="sc">/</span>N)</span>
<span id="cb80-33"><a href="#cb80-33" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(accept.rate,<span class="at">format=</span><span class="st">&#39;latex&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>      <span class="co">#display 4 graphs together</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>    refline <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">qexp</span>(.<span class="dv">975</span>),<span class="fu">qexp</span>(.<span class="dv">975</span>))</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>    rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x,  rw4<span class="sc">$</span>x)</span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>        <span class="fu">plot</span>(rw[,j], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a>             <span class="at">xlab=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>             <span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(rw[,j]))</span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a>        <span class="fu">abline</span>(<span class="at">h=</span>refline)</span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2/7a2///bkDrbtpDb////tmb/25D//7b//9v///85SQBDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHkUlEQVR4nO2d62KiOABG02mdvdTdne3UvdQdtbz/Qy4SCCEEPpCgKOf8aFXCFzjNBdtITQa9mFsfwNJBkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECQYI+i0fc2/HowxXz7mOp7FMVrQ/vnH+dHbbEe0MMYKKtUUmlbBWEHHTSHosJpOlrgFmbthHkHn5JesGq4nxt2UWQRlhaOn93wi6/CDoCvHzceVBQVde3gPvxkzCdrnCuwg3TGLmUtSb8E8gvb5+HPankdpBMX4/P5afM2neATFqN5g7J5/ICiGbUE5uxcERam05FdDCIqyt3NY3pYQNKleBIk4BIk4BIk4BIk4BIk4BIk4BIk4BIk4BIUpwe/CESTiECTiECTiECTiECTiECTiECTiECTiVipowAozBIkVZghS64PGp96G2QSJFWYIogX1MHyF2UoFZYNXmK1X0MA4BIUp/MJsXByCRNxKBdlZzMJ1UIzOVS9h3FoF5YZeBsWtVlB+BdT/OajVCxoYhyARhyARhyARhyARhyAR99CC/p7yadRHFXT6Vj0/biZ9XPdhBW2f3osHu4n3DHhUQfl7iPOvUo8bI95KdKWs4PdBB/P0hynb0eR6H1FQ2YjS1PuIgvbnFjT5fgoPK+i0PTef/GvXnyvGxT2cIGYxUZDroBEFuZK+rOCoOASJOASJOASJOASJOASJuJUKYpWrgFWuAtYoCrpXua7hF2YDoAUJ7nqVa3Djubmm+QmrXM3wm+PN4Tev3I+92XXQ3XArQZWn2KYhR2W8FF3PgBfdxoW0IHc0kU0IkoJMfFMYIA8qGtKfvDhBreBrCeqooBp3qlKqisYBpcMJah9mKKjjPHoOqn65kW5M47u/zX9YCeqrvbfSJCQS5DVA46W6V1ciKKaqV5B5WEGmOOUOQSYuyDsTX5Bx82Fty/jf/UHGz1icIP947QmXgtwZRAWVEgNBxdMqtE6qd8m0oNZLY84oFYEgU52LLyhrCjJVofpVJ6hKME5Q5gQZX0zZRuxT77FXwWIFZXFBDVENQcYZcc8yT1Al1F14Vo01bLJZS5CzdHVB4VucTkHeT9Lrat6QVW9zfcsXZLeWO3tivGbYI8jv14NPbZKYrjjjUZ9hNXBUY6Y/WHg9yDWVlqAsEOSG38wNTGVUw7QvyCxJkNdzmoIazc2diddGGl2t6k9+5/QbnGtHrtU6Fc0BqzEZjDyjVLgDr1p0vaEWlHnDiVMSHL03QtXn35CZucdex/baltep/K499rznEpS1BfltJGtO7sGBeOWigrzS5bhfPjau8YadanmCguigBQ0Q5Pbzhphhgrwa68h7ENQYJcOaW13M7Vf1QV+t8XcbIihSxbgzSsTlgoIU/2ff/N7M7hYUDmzLEhTZME6Q9yTcoV9Q0K26Yu9A0KTsuKCwGILKJyby4piAoTsphq/uiG2Y/KO4E0GDVnfENiRtq8sVxP84FIKG3cMstmHGFnTBTjdrQZ31XD44y3oWJOjcNhfxXzKTjvgpa+pY3TG+a09ksYKuHDdfPXMKcv+HLU3cRSBIgKC5QZAAQYJHn8UmczNBd8ONBI0LHVjuJsUuLJ42FEFpyiFoicUuLJ42FEFpyiFoicUuLJ42FEFpyj2eoEcCQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAgvaCD6bstdb3GyJXr36GP408fqSNbJBd0OK8f6j6649f3oJzYoYfTtlgImDKyTWpB9u/Su85bd1eLG105tUM3h3I5csLICKkF2UWe+86F1PuXoJzaoZODebVq0kXGSC6oaO9di2Dzn+vP+Xjx6pVTO/Rh90oa2SK1INv1OweA0/a8PHb3WpcTO/RXdnaQNrLFlQWVhb58pBOUNrLFtbuYLbR5S9jFkka2uPYgbQt9fU8yovqCEkW2uPI0b489P7Ekc3IhKG1ki2tfKBaHnY+oSa7qylksZWSL9G819v2X+bt8Tn5rlBM79FB2sZSRLXizKkCQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEGCexJkV/1mx41d9Hsd7khQuer38Pwjf3g1Q/cjqFz1axf/JFodNYC7EVSt+nXLxq/EwgR9/rUp7g8VvUtaIejw5d9tx/ZZWJig3fM/2fFb/Ea6VtD+3NE+v690DCrXp/5aPNmVdxtzLqygp4RLWAewLEH2vE+/xYcZK8h+gGXTcUv05CxSUMcN4csxqPEJn9lZliCrpmwe8S5mi6y1i2WHpz/zEbjjduflh3vyrX03A03MwgRl//1uzC99s5j9vxWrneaXB4IECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSPA/YTGn16BFfsEAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>     <span class="co">#reset to default</span></span></code></pre></div>
<p>可以发现除第一个外的另外三条链都很快收敛到了目标拉普拉斯分布中.为比较具体效果，我将以前200次为预烧期，比较后续序列的QQ图</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">200</span>)</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">qexp</span>(p, <span class="dv">1</span>)</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">rev</span>(y), y)</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> rw1<span class="sc">$</span>x[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a>  y2 <span class="ot">&lt;-</span> rw2<span class="sc">$</span>x[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>  y3 <span class="ot">&lt;-</span> rw3<span class="sc">$</span>x[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a>  y4 <span class="ot">&lt;-</span> rw4<span class="sc">$</span>x[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>  </span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a>  Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y1, p)</span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>  <span class="fu">qqplot</span>(z, Q1, <span class="at">main=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[<span class="dv">1</span>],<span class="dv">3</span>))),</span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;Laplace Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb83-13"><a href="#cb83-13" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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543aBySTGLiDOZSV/0tAc/SUMy7sgQB1MvTr/PkfBxGIIk6pU/FgPKblZdRBZ1z69eUiSd/rtsTl9ONp+g+Pn3/+r7rEVGGRpD8aWGFAKsvM1PhXkRKMn5JOPSMTOB3nIyQYHTA3fPqqAakSlxMPt+eJWRYfpArrrGNxKgtIvOWNt1yevni//av+UnWWTaYnHV42SA7jTYnpPytAunDcm+S0yvuggelccuqcN18qJvMnEyBdQhNbAOnCl1MSQoUBTf7h0794D/o8xz+Li2LzpRzWdZiq8RJTJUyAdGGxHejOfJDoFecPgJYvNz1o1uKkxfUoeOgS1h6kK47MC1kakPALMl3jcVTnrL9cfND6996L7QPP/5lKKJezKnEDaFs4ftwv34MuJ8aHGB7eK09RfykGIL6VQgxp+pffCUJMRPA+v0//W0osgI6bUYwXFl3JustjtwoBkn7hKIN6p9afD385zDOZV/3ldh60uNjZrUxf8FyyP65KLOP+h3mQ7GLRmVfHaovVkIyoPyV4MYq/7ghQHREgILofBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBA/wPnmj63LvgZ7QAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>  Q2 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y2, p)</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>  <span class="fu">qqplot</span>(z, Q2, <span class="at">main=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[<span class="dv">2</span>],<span class="dv">3</span>))),</span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;Laplace Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a>  Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y3, p)</span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>  <span class="fu">qqplot</span>(z, Q3, <span class="at">main=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[<span class="dv">3</span>],<span class="dv">3</span>))),</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;Laplace Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>  Q4 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y4, p)</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>  <span class="fu">qqplot</span>(z, Q4, <span class="at">main=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[<span class="dv">4</span>],<span class="dv">3</span>))),</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;Laplace Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从QQ图来看，<span class="math inline">\(\sigma=\)</span> 4 和 16
时较好。考虑到接受率，认为<span class="math inline">\(\sigma=\)</span> 4
时更好。</p>
</div>
<div id="ex-9.7" class="section level2">
<h2>Ex 9.7</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">9</span> <span class="co">#correlation</span></span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb87-12"><a href="#cb87-12" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb87-13"><a href="#cb87-13" tabindex="-1"></a></span>
<span id="cb87-14"><a href="#cb87-14" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2) <span class="co">#initialize</span></span>
<span id="cb87-15"><a href="#cb87-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb87-16"><a href="#cb87-16" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb87-17"><a href="#cb87-17" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb87-18"><a href="#cb87-18" tabindex="-1"></a>X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb87-19"><a href="#cb87-19" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb87-20"><a href="#cb87-20" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb87-21"><a href="#cb87-21" tabindex="-1"></a>X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb87-22"><a href="#cb87-22" tabindex="-1"></a>}</span>
<span id="cb87-23"><a href="#cb87-23" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb87-24"><a href="#cb87-24" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb87-25"><a href="#cb87-25" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb87-26"><a href="#cb87-26" tabindex="-1"></a><span class="fu">lines</span>(x[,<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb87-27"><a href="#cb87-27" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="fu">c</span>(<span class="fu">expression</span>(X),<span class="fu">expression</span>(Y)),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> x[, <span class="dv">1</span>]</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> x[, <span class="dv">2</span>]</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.55851 -0.27926 -0.00391  0.28946  1.61701 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.013005   0.006844     1.9   0.0575 .  
## X           0.901053   0.007035   128.1   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4328 on 3998 degrees of freedom
## Multiple R-squared:  0.804,  Adjusted R-squared:  0.804 
## F-statistic: 1.64e+04 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>我们可以看到得到的数据很好得被线性模型拟合了。接下来来看看残差是不是正态的以及其方差是否恒定。</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">qqnorm</span>(fit<span class="sc">$</span>res)</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a><span class="fu">qqline</span>(fit<span class="sc">$</span>res, <span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从QQ图可以看出，残差是正态的。</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">plot</span>(fit<span class="sc">$</span>fit, fit<span class="sc">$</span>res, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从以上散点图可看出，残差并没有表现出异方差的形状，故可认为残差的方差恒定。</p>
</div>
<div id="ex-9.10" class="section level2">
<h2>Ex 9.10</h2>
<p>使用Example9.1中的函数：</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a>psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a>B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb92-9"><a href="#cb92-9" tabindex="-1"></a>psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb92-10"><a href="#cb92-10" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb92-11"><a href="#cb92-11" tabindex="-1"></a>v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb92-12"><a href="#cb92-12" tabindex="-1"></a>r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb92-13"><a href="#cb92-13" tabindex="-1"></a><span class="fu">return</span>(r.hat)</span>
<span id="cb92-14"><a href="#cb92-14" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a><span class="cf">if</span> (x <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a><span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a><span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a><span class="fu">return</span>((x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a>}</span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a>Rayleigh.MH.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, m, x0) {</span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb93-10"><a href="#cb93-10" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb93-11"><a href="#cb93-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb93-12"><a href="#cb93-12" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb93-13"><a href="#cb93-13" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb93-14"><a href="#cb93-14" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb93-15"><a href="#cb93-15" tabindex="-1"></a>    den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb93-16"><a href="#cb93-16" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den)</span>
<span id="cb93-17"><a href="#cb93-17" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb93-18"><a href="#cb93-18" tabindex="-1"></a>    <span class="cf">else</span> x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb93-19"><a href="#cb93-19" tabindex="-1"></a>  }</span>
<span id="cb93-20"><a href="#cb93-20" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb93-21"><a href="#cb93-21" tabindex="-1"></a>}</span>
<span id="cb93-22"><a href="#cb93-22" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb93-23"><a href="#cb93-23" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span>sigma, sigma<span class="sc">^</span><span class="dv">2</span>, sigma<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb93-24"><a href="#cb93-24" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb93-25"><a href="#cb93-25" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb93-26"><a href="#cb93-26" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> m)</span>
<span id="cb93-27"><a href="#cb93-27" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) X[i, ] <span class="ot">&lt;-</span> <span class="fu">Rayleigh.MH.chain</span>(sigma, m, x0[i])</span>
<span id="cb93-28"><a href="#cb93-28" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb93-29"><a href="#cb93-29" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) psi[i, ] <span class="ot">&lt;-</span> psi[i, ]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb93-30"><a href="#cb93-30" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi)</span>
<span id="cb93-31"><a href="#cb93-31" tabindex="-1"></a>rhat</span></code></pre></div>
<pre><code>## [1] 1.19999</code></pre>
<p>可以看到<span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">library</span>(coda)</span></code></pre></div>
<pre><code>## Warning: package &#39;coda&#39; was built under R version 4.2.3</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">1</span>, ])</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">2</span>, ])</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">3</span>, ])</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">4</span>, ])</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(X1, X2, X3, X4)</span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">gelman.diag</span>(Y))</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]       1.01       1.04</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="fu">gelman.plot</span>(Y, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="ex-12" class="section level2">
<h2>Ex 1(2)</h2>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>v <span class="ot">&lt;-</span> u<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a><span class="co"># MLE 算法</span></span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>  <span class="fu">sum</span>((v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)))</span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a>}</span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(L,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))<span class="sc">$</span>root</span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE算法得到的估计为&quot;</span>,<span class="fu">round</span>(lambda_mle,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## MLE算法得到的估计为 0.072</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="co"># E-M 算法</span></span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(u)</span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>  <span class="fu">sum</span>(lambda<span class="sc">*</span>(u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)))</span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>}</span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a>  n<span class="sc">*</span>lambda<span class="sc">/</span>(<span class="fu">f</span>(lambda)<span class="sc">+</span>n)</span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a>}</span>
<span id="cb102-9"><a href="#cb102-9" tabindex="-1"></a>lambda0 <span class="ot">&lt;-</span> .<span class="dv">000001</span> <span class="co">#初始值</span></span>
<span id="cb102-10"><a href="#cb102-10" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb102-11"><a href="#cb102-11" tabindex="-1"></a><span class="cf">repeat</span>{</span>
<span id="cb102-12"><a href="#cb102-12" tabindex="-1"></a>  lambda_EM <span class="ot">&lt;-</span> <span class="fu">g</span>(lambda0)</span>
<span id="cb102-13"><a href="#cb102-13" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb102-14"><a href="#cb102-14" tabindex="-1"></a>  <span class="cf">if</span>((<span class="fu">abs</span>(lambda_EM<span class="sc">-</span>lambda0)<span class="sc">&lt;</span>.Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.25</span>) <span class="sc">||</span> (iter <span class="sc">&gt;</span> <span class="dv">1000</span>)) <span class="cf">break</span></span>
<span id="cb102-15"><a href="#cb102-15" tabindex="-1"></a>  lambda0 <span class="ot">&lt;-</span> lambda_EM</span>
<span id="cb102-16"><a href="#cb102-16" tabindex="-1"></a>}</span>
<span id="cb102-17"><a href="#cb102-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;E-M算法得到的估计为&quot;</span>,<span class="fu">round</span>(lambda_EM,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## E-M算法得到的估计为 0.072</code></pre>
</div>
<div id="ex-11.8" class="section level2">
<h2>Ex 11.8</h2>
<p>使用书上的solve.game 函数</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a><span class="co">#solve the two player zero-sum game by simplex method</span></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a><span class="co">#optimize for player 1, then player 2</span></span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a><span class="co">#maximize v subject to ...</span></span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a><span class="co">#let x strategies 1:m, and put v as extra variable</span></span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a><span class="co">#A1, the &lt;= constraints</span></span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a>min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A <span class="co">#so that v &gt;= 0</span></span>
<span id="cb104-10"><a href="#cb104-10" tabindex="-1"></a>max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb104-11"><a href="#cb104-11" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb104-12"><a href="#cb104-12" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb104-13"><a href="#cb104-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb104-14"><a href="#cb104-14" tabindex="-1"></a>it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb104-15"><a href="#cb104-15" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb104-16"><a href="#cb104-16" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n)) <span class="co">#constraints &lt;=</span></span>
<span id="cb104-17"><a href="#cb104-17" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb104-18"><a href="#cb104-18" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>))) <span class="co">#constraints sum(x)=1</span></span>
<span id="cb104-19"><a href="#cb104-19" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb104-20"><a href="#cb104-20" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb104-21"><a href="#cb104-21" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb104-22"><a href="#cb104-22" tabindex="-1"></a><span class="co">#the ’solution’ is [x1,x2,...,xm | value of game]</span></span>
<span id="cb104-23"><a href="#cb104-23" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb104-24"><a href="#cb104-24" tabindex="-1"></a><span class="co">#minimize v subject to ...</span></span>
<span id="cb104-25"><a href="#cb104-25" tabindex="-1"></a><span class="co">#let y strategies 1:n, with v as extra variable</span></span>
<span id="cb104-26"><a href="#cb104-26" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb104-27"><a href="#cb104-27" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m)) <span class="co">#constraints &lt;=</span></span>
<span id="cb104-28"><a href="#cb104-28" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb104-29"><a href="#cb104-29" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>))) <span class="co">#constraints sum(y)=1</span></span>
<span id="cb104-30"><a href="#cb104-30" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb104-31"><a href="#cb104-31" tabindex="-1"></a>sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb104-32"><a href="#cb104-32" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb104-33"><a href="#cb104-33" tabindex="-1"></a>soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,</span>
<span id="cb104-34"><a href="#cb104-34" tabindex="-1"></a><span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb104-35"><a href="#cb104-35" tabindex="-1"></a><span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb104-36"><a href="#cb104-36" tabindex="-1"></a><span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A)</span>
<span id="cb104-37"><a href="#cb104-37" tabindex="-1"></a>soln</span>
<span id="cb104-38"><a href="#cb104-38" tabindex="-1"></a>}</span>
<span id="cb104-39"><a href="#cb104-39" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb104-40"><a href="#cb104-40" tabindex="-1"></a>               <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb104-41"><a href="#cb104-41" tabindex="-1"></a>               <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb104-42"><a href="#cb104-42" tabindex="-1"></a>               <span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb104-43"><a href="#cb104-43" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb104-44"><a href="#cb104-44" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb104-45"><a href="#cb104-45" tabindex="-1"></a>               <span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb104-46"><a href="#cb104-46" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb104-47"><a href="#cb104-47" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb104-48"><a href="#cb104-48" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co">#needed for simplex function</span></span>
<span id="cb104-49"><a href="#cb104-49" tabindex="-1"></a>B <span class="ot">&lt;-</span> A<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb104-50"><a href="#cb104-50" tabindex="-1"></a>s0 <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(A)</span>
<span id="cb104-51"><a href="#cb104-51" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(B)</span>
<span id="cb104-52"><a href="#cb104-52" tabindex="-1"></a>s0<span class="sc">$</span>v <span class="co"># A的value</span></span></code></pre></div>
<pre><code>## x10 
##   0</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>s<span class="sc">$</span>v <span class="co"># B的value</span></span></code></pre></div>
<pre><code>## x10 
##   2</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(s<span class="sc">$</span>x, s<span class="sc">$</span>y),<span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">round</span>(s<span class="sc">$</span>x<span class="sc">*</span><span class="dv">61</span>, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## x1 x2 x3 x4 x5 x6 x7 x8 x9 
##  0  0 25  0 20  0 16  0  0</code></pre>
<p>游戏B的极值点为原游戏A的其中一个极值点（11.15）</p>
</div>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
<div id="ex-2.1.4" class="section level2">
<h2>Ex 2.1.4</h2>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
<p>因为unlist()可以使得有多层结构的list扁平化。</p>
</div>
<div id="ex-2.3.1" class="section level2">
<h2>Ex 2.3.1</h2>
<p>What does dim() return when applied to a vector?</p>
<p>NULL</p>
<p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
<p>TRUE，因为一个二维的array其实就是一个矩阵。</p>
</div>
<div id="ex-2.4.5" class="section level2">
<h2>Ex 2.4.5</h2>
<p>What does as.matrix() do when applied to a data frame with columns of
different types?</p>
<p>会返回一个类型为此前最高级别类型的矩阵。</p>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
<p>可以，比如：</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>X <span class="ot">&lt;-</span>cars</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a><span class="fu">dim</span>(X[<span class="cn">FALSE</span>,])</span></code></pre></div>
<pre><code>## [1] 0 2</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="fu">dim</span>(X[,<span class="cn">FALSE</span>])</span></code></pre></div>
<pre><code>## [1] 50  0</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="fu">dim</span>(X[<span class="cn">FALSE</span>,<span class="cn">FALSE</span>])</span></code></pre></div>
<pre><code>## [1] 0 0</code></pre>
</div>
<div id="ex-11.1.2" class="section level2">
<h2>Ex 11.1.2</h2>
<p>The function below scales a vector so it falls in the range [0,1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>}</span></code></pre></div>
<p>对data.frame X，只需用lapply来实现X</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(X, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x))</span></code></pre></div>
</div>
<div id="ex-11.2.5" class="section level2">
<h2>Ex 11.2.5</h2>
<p>Use vapply() to:</p>
<ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data
frame.</li>
</ol>
<p>对data.frame X ，可通过一下语句实现</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="fu">vapply</span>(X, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply()twice.)</li>
</ol>
<p>对data.frame X ，可通过一下语句实现</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="fu">vapply</span>(X[<span class="fu">vapply</span>(X, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))],</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>       sd, </span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>       <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="ex-9.8" class="section level2">
<h2>Ex 9.8</h2>
<ul>
<li>Write an R function.</li>
<li>Write an Rcpp function.</li>
<li>Compare the computation time of the two functions with the function
“microbenchmark”.</li>
</ul>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb122-5"><a href="#cb122-5" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N, n, a, b) {</span>
<span id="cb122-6"><a href="#cb122-6" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb122-7"><a href="#cb122-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb122-8"><a href="#cb122-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb122-9"><a href="#cb122-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb122-10"><a href="#cb122-10" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x<span class="sc">+</span>a, n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb122-11"><a href="#cb122-11" tabindex="-1"></a>    mat[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb122-12"><a href="#cb122-12" tabindex="-1"></a>  }</span>
<span id="cb122-13"><a href="#cb122-13" tabindex="-1"></a>  mat</span>
<span id="cb122-14"><a href="#cb122-14" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.2.3</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a>dir_cpp <span class="ot">&lt;-</span> <span class="st">&#39;../HW9/&#39;</span></span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a><span class="co"># Can create source file in Rstudio</span></span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a><span class="co">#sourceCpp(paste0(dir_cpp,&quot;gibbsC.cpp&quot;))</span></span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.2.3</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR=</span><span class="fu">gibbsR</span>(N, n, a, b),<span class="at">gibbsC=</span><span class="fu">gibbsC</span>(N, n, a, b))</span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr       lq   median      uq
## 1 gibbsR 54.78295 57.85680 61.1745
## 2 gibbsC  5.34075  5.47345  5.6026</code></pre>
<p>C++ 函数为：</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp<span class="op">;</span></span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a>NumericMatrix gibbsC<span class="op">(</span><span class="dt">int</span> N<span class="op">,</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb129-5"><a href="#cb129-5" tabindex="-1"></a>  NumericMatrix mat<span class="op">(</span>N<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb129-6"><a href="#cb129-6" tabindex="-1"></a>  <span class="dt">double</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb129-7"><a href="#cb129-7" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb129-8"><a href="#cb129-8" tabindex="-1"></a>    x <span class="op">=</span> rbinom<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> y<span class="op">)[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb129-9"><a href="#cb129-9" tabindex="-1"></a>    y <span class="op">=</span> rbeta<span class="op">(</span><span class="dv">1</span><span class="op">,</span> x<span class="op">+</span>a<span class="op">,</span> n<span class="op">-</span>x<span class="op">+</span>b<span class="op">)[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb129-10"><a href="#cb129-10" tabindex="-1"></a>    mat<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">)</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb129-11"><a href="#cb129-11" tabindex="-1"></a>    mat<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb129-12"><a href="#cb129-12" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb129-13"><a href="#cb129-13" tabindex="-1"></a>  <span class="cf">return</span><span class="op">(</span>mat<span class="op">);</span></span>
<span id="cb129-14"><a href="#cb129-14" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
